## Содержрание

* [Описание](#описание)
* [Что было сделано](#что-было-сделано)
* [Как запустить](#как-запустить)

## Описание:

Из-за того что моя тема диплома не подходит под выполнение дз от слова совсем, было выбрано решение сгенерировать тему
дз при помощи модельки. Суть приложения - управление айтемами на складе. На данный момент бизнесовый рест включает в
себя только 2 ручки - создание продукта и получение всех продуктов (в будущем будет дополнено).

## Что было сделано

* При помощи той же модельки был сгенерирован [сваггер](/src/main/resources/openapi/inventory-service.yaml), после
  немного
  подправлен руками
* Был подключен openapi-generator для создания api и моделек на основании сваггера. Аутентификация на
  основе Spring security + jwt токенов:
* [Конфиг Spring security](/src/main/java/ru/hse/pipo/configuration/SecurityConfiguration.java) - настраивает все
  секурити. Из примечательного: разрешен поход на /public/**,
* [Фильтр для JWT токенов](/src/main/java/ru/hse/pipo/filter/JwtAuthenticationFilter.java) - Через него проходят
  запросы, если в запросе есть хедер с jwt токеном (Authorization: Bearer <token>), то фильтр валидирует токен и
  подкладывает в контекст spring security аутентификацию
* Ассиметричная работа с jwt, это позволит если что вынести в отдельный микросервис механизм авторизации.
* Все основные конфиги передаются через env переменные
* Для миграций подключен liquibase, миграции располагаются [туть](/src/main/resources/db/changelog/migrations)
* Максимально простой [github-actions](/.github/workflows/build.yml). При билде скипаю тесты - пока не было времени
  нормально написать для них инфру (поднять тестконтейнер и тд)

## Как запустить

Пример локального запуска в [docker-compose](/docker-compose.yaml)

1. Создаем private и public серт в корне проекта:

`openssl genpkey -algorithm RSA -out private.pem -pkeyopt rsa_keygen_bits:2048`

`openssl rsa -pubout -in private.pem -out public.pem`

2. поднимаем docker-compose

`docker-compose up`
